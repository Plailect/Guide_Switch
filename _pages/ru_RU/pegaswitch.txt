---
title: "PegaSwitch"
---

{% include toc title="Содержание" %}

### Обязательно к прочтению

PegaSwitch - это программный комплекс для взаимодействия со Switch, ориентированный на разработчиков и разрабатываемый командой ReSwitched. Он совместим с версиями прошивки 1.0.0 - 3.0.0.

Комплекс использует комбинацию уязвимостей браузера на базе WebKit, предоставляя пользователю оболочку, которой можно воспользоваться для чтения / записи памяти, вызова нативных функций и прочих способов исследования функционала Switch.

Обратите внимание, что текущий эксплойт для хоумбрю имеет побочный эффект, при котором база данных Mii повреждается. Хоть это и безвредно для самой консоли, все Mii, созданные пользователем, будут потеряны.
{: .notice--warning}

### Что понадобится

* Поддерживаемая операционная система
  + MacOS и большинство дистрибутивов Linux поддерживаются
  + Windows лучше поддерживается с использованием [Windows Subsystem for Linux](https://docs.microsoft.com/en-us/windows/wsl/install-win10) (англ.)
* Система контроля версий [git](https://git-scm.com/)
* [Node.JS](https://nodejs.org/en/download/package-manager/) (текущая версия)

### Инструкция

#### Часть I - Настройка сети

PegaSwitch работает при помощи размещения [Captive portal](https://en.wikipedia.org/wiki/Captive_portal) (англ.), используя переадресацию DNS.

Для успешной работы ваша консоль должна иметь доступ к вашему компьютеру через сеть.

1. Убедитесь, что никакие приложения не привязаны к UDP порту 53 или TCP портам 80 и 8100
  + WSL: смотрите секцию "Прослушиваемые порты" на вкладке "Сеть" в Мониторе ресурсов `resmon.exe`
  + Linux / MacOS: смотрите вывод `sudo netstat -tulpn`
1. Убедитесь, что файервол не блокирует входящие подключения на этих портах

#### Часть II - Запуск PegaSwitch

~~~ bash
# клонируем репозиторий
git clone https://github.com/reswitched/pegaswitch

# установка зависимостей
cd pegaswitch
npm install

# запускаем PegaSwitch
# пользователям Windows: пропустите 'sudo'
sudo node start.js
~~~

#### Часть III - Конфигурация DNS

Обратите внимание, что адреса этих DNS серверов должны быть настроены для каждой сети, к которой вы подключаете свою консоль, чтобы эксплойт сработал.
{: .notice--info}

1. Откройте Системные настройки на вашей консоли
1. Перейдите в `Интернет` -> `Интернет-настройки`
1. Выберите вашу текущую сеть
  + Она обозначена зелёной галочкой рядом с сетью
1. Выберите "Изменить настройки"
1. Измените "Настройки DNS" на "Вручную"
1. Измените значения полей "Первичный DNS" и "Вторичный DNS" на IP-адрес вашего компьютера
  + Эта информация будет отображаться в PegaSwitch
1. Сохраните настройки сети
1. Вернитесь в `Интернет-настройки`

#### Часть IV - Первая установка

1. Перейдите в `Интернет` -> `Интернет-настройки`
1. Выберите вашу текущую сеть
1. Выберите "Подключиться к этой сети"
1. Если соединение с DNS прошло успешно, вы увидите сообщение "Регистрация необходима для использования этой сети."
1. Выберите "Далее"
1. Будет загружена веб-страница PegaSwitch
1. Если эксплойт сработал корректно, оболочка PegaSwitch будет подключена к вашей консоли

#### Часть V - Альтернативные браузер-апплеты (необязательно)

Существуют [несколько](http://switchbrew.org/index.php?title=Internet_Browser#Browser_Applets) браузер-апплетов на Switch, и все они могут быть использованы для запуска эксплойта браузера.

Для первого запуска эксплойта использовался тест подключения; в дальнейшем гораздо удобнее будет использовать другой браузер-апплет.

Запуск эксплойта с использованием любого из этих методов будет работать так же, как и при тесте подключения, который был использован ранее.

##### Форма входа в eShop

Для этого метода требуется создать вторую учётную запись на консоли. Не соединяйте её с Nintendo Account.

1. Запустите Nintendo eShop
1. Выберите вторую учётную запись
1. Выберите "Войти и присоединить"
1. Запустится браузер-апплет

##### Форма обновления игры

Для этого метода на главном экране должна присутствовать хотя бы одна игра.

Обратите внимание: если вы не подключены к корректным DNS серверам, этот метод *обновит* вашу консоль. Это опасно!
{: .notice--danger}

1. Нажмите (+) на любой выделенной в меню игре
1. Во вкладке "Обновление программы" выберите "Через Интернет"
1. Запустится браузер-апплет

___

Теперь вы можете с лёгкостью подключаться к вашей консоли с помощью PegaSwitch.
{: .notice--success}

В целях отладки вы можете [включить отображение дополнительной информации об ошибках](troubleshooting#включение-дополнительной-информации-об-ошибках).
{: .notice--info}

### Вернитесь на страницу [Разработка хоумбрю](homebrew-development)
{: .notice--primary}
