---
title: "PegaSwitch"
---

{% include toc title="Tabla de contenidos" %}

### Lectura requerida

PegaSwitch es un set de herramientas de explotación para la Switch enfocado a desarrolladores, desarrollado por ReSwitched. Es compatible con las versiones 1.0.0 a 3.0.0 de firmware.

El set de herramientas usa una combinación de vulnerabilidades para tomar control del navegador basado en WebKit, dándole al usuario una consola de comandos que puede usar para leer y escribir memoria, llamar funciones nativas y además explorar la funcionalidad de la Switch.

Ten en cuenta que el exploit de homebrew actual tiene el efecto secundario de corromper la base de datos de Miis de tu consola. Más allá de que el efecto no es dañino, resultará en la pérdida de cualquier Mii creado por el usuario.
{: .notice--warning}

### Qué necesitas

* Un sistema operativo compatible
  + MacOS y la mayoría de las distribuciones de Linux son compatibles
  + Windows tiene mejor soporte si se usa una distribución del [Subsistema de Windows para Linux](https://docs.microsoft.com/en-us/windows/wsl/install-win10)
* El sistema de control de versiones [git](https://git-scm.com/)
* El runtime de JavaScript [Node.JS](https://nodejs.org/en/download/package-manager/) (release actual)

### Instrucciones

#### Sección I - Configuración de red

PegaSwitch funciona mediante la creación de un [portal cautivo](https://en.wikipedia.org/wiki/Captive_portal) usando redirección de DNS.

Para que esto funcione, tu consola debe ser capaz de conectarse a tu PC a través de la red.

1. Asegúrate de que no hay otras aplicaciones que estén utilizando el puerto UDP 53 o los puertos TCP 80 u 8100
  + WSL: look at the "Listening Ports" section of the "Network" tab in `resmon.exe`
  + Linux / MacOS: view the output of `sudo netstat -tulpn`
1. Ensure your firewall does not block incoming connections to any of these ports

#### Section II - Running PegaSwitch

~~~ bash
# clonar el repositorio
git clone https://github.com/reswitched/pegaswitch

# instalar dependencias
cd pegaswitch
npm install

# start PegaSwitch
# Windows users: omit the 'sudo'
sudo node start.js
~~~

#### Section III - DNS Configuration

Note that these DNS servers will need to be set on each network you connect your device to for it to be able to trigger the exploit.
{: .notice--info}

1. Get your PC's IP address with `ifconfig` (or `ipconfig` on windows)
1. Launch System Settings on your device
1. Entra en `Internet` -> `Configuración de internet`
1. Selecciona tu red actual
  + Esta se encuentra indicada por una marca verde ubicada al lado de dicha red
1. Selecciona "Modificar los ajustes"
1. Establece la "Configuración del DNS" en "Modo manual"
1. Set "Primary DNS" and "Secondary DNS" to your PC's IP address
1. Guarda la configuración de red
1. Return to `Internet Settings`

#### Section IV - Initial Connection

1. Entra en `Internet` -> `Configuración de internet`
1. Selecciona tu red actual
1. Selecciona "Conectarse a esta red"
1. Si la conexión por DNS fue exitosa, aparecerá un mensaje diciendo "Es necesario registrarse para poder utilizar esta red."
1. Selecciona "Siguiente"
1. Se cargará el sitio web de PegaSwitch
1. If the exploit was successful, you will now have a PegaSwitch shell connected to your console

#### Section V - Alternative Browser Applets (Optional)

There are actually [multiple](http://switchbrew.org/index.php?title=Internet_Browser#Browser_Applets) internet browsers on the Switch, and any of them can be used to trigger the browser exploit.

While we used the connection test browser applet to initially trigger the exploit, it may be more convenient in the future to use another browser applet.

Triggering the browser exploit using either of these methods will have the same effect as triggering the exploit through the Connection Test method we used before.

##### eShop Sign In Prompt

To use this method, create a second account on your device. Do not connect it to a Nintendo Account.

1. Launch Nintendo eShop
1. Select the second account
1. Select "Sign In and link"
1. The browser applet will launch

##### Game Update Prompt

To use this method, you must have at least one game on your home screen.

Note that, if you were not connected to the correct DNS servers, this method would *update* your device. It is dangerous!
{: .notice--danger}

1. Press (+) with any game highlighted
1. In the "Software Update" tab, select "Via the Internet"
1. The browser applet will launch

___

You can now easily connect to your device using the PegaSwitch environment.
{: .notice--success}

For debugging purposes, you may want to [enable extra error info](troubleshooting#enable-extra-error-info).
{: .notice--info}

### Return to [Homebrew Development](homebrew-development)
{: .notice--primary}
