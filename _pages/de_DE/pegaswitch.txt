---
title: "PegaSwitch"
---

{% include toc title="Inhalt" %}

### Wichtig

PegaSwitch is a developer-focused exploitation toolkit for the Switch developed by ReSwitched. It is compatible with firmware versions 1.0.0 - 3.0.0.

The toolkit uses a combination of vulnerabilities to take over the WebKit-based browser, giving the user a shell which can be used to read / write memory, call native functions, and otherwise explore the functionality of the Switch.

Note that the current homebrew exploit has the side-effect of corrupting your device's Mii Database. Obwohl dieser Effekt harmlos ist, er wird alle benutzererstellten Miis löschen.
{: .notice--warning}

### Was du brauchst

* Ein unterstütztes Betriebssystem
  + MacOS and most linux distributions are supported
  + Windows is best supported using a [Windows Subsystem for Linux](https://docs.microsoft.com/en-us/windows/wsl/install-win10) distribution
* The [git](https://git-scm.com/) version control system
* The [Node.JS](https://nodejs.org/en/download/package-manager/) JavaScript runtime (current release)

### Anleitung

#### Section I - Network Configuration

PegaSwitch works by hosting a [captive portal](https://en.wikipedia.org/wiki/Captive_portal) using DNS redirection.

For this to work, your device must be able to connect to your PC over the network.

1. Ensure no other applications are bound to UDP port 53 or TCP ports 80 and 8100
  + WSL: look at the "Listening Ports" section of the "Network" tab in `resmon.exe`
  + Linux / MacOS: view the output of `sudo netstat -tulpn`
1. Ensure your firewall does not block incoming connections to any of these ports

#### Section II - Running PegaSwitch

~~~ bash
# Klone das Repository
git clone https://github.com/reswitched/pegaswitch

# Installiere die Abhängigkeiten
cd pegaswitch
npm install

# start PegaSwitch
# Windows users: omit the 'sudo'
sudo node start.js
~~~

#### Section III - DNS Configuration

Note that these DNS servers will need to be set on each network you connect your device to for it to be able to trigger the exploit.
{: .notice--info}

1. Get your PC's IP address with `ifconfig` (or `ipconfig` on windows)
1. Launch System Settings on your device
1. Navigiere zu "Internet" -> "Interneteinstellungen"
1. Wähle dein aktuelles Netzwerk
  + Dieses ist durch einen grünen Haken neben dem Netzwerk markiert
1. Wähle "Einstellungen ändern"
1. Setze "DNS-Einstellungen" auf "Manuell"
1. Set "Primary DNS" and "Secondary DNS" to your PC's IP address
1. Speichere die Einstellungen
1. Return to `Internet Settings`

#### Section IV - Initial Connection

1. Navigiere zu `Internet` -> `Verbindung testen`
1. Wähle dein aktuelles Netzwerk
1. Wähle "Verbindung zu diesem Netzwerk"
1. Wenn die DNS Verbindung erfolgreich war, wirst du die Nachricht "Eine Registrierung wird benötigt um dieses Netzwerk nutzen zu können." sehen
1. Wähle "Weiter"
1. Die PegaSwitch Website wird laden
1. If the exploit was successful, you will now have a PegaSwitch shell connected to your console

#### Abschnitt V - Alternative Browser Applets (optional)

There are actually [multiple](http://switchbrew.org/index.php?title=Internet_Browser#Browser_Applets) internet browsers on the Switch, and any of them can be used to trigger the browser exploit.

While we used the connection test browser applet to initially trigger the exploit, it may be more convenient in the future to use another browser applet.

Triggering the browser exploit using either of these methods will have the same effect as triggering the exploit through the Connection Test method we used before.

##### eShop Einloggen-Fenster

Um diese Methode zu nutzen, erstelle einen zweiten Account auf deinem Gerät. Verbinde ihn nicht mit einen Nintendo Account.

1. Starte den Nintendo eShop
1. Wähle den zweiten Account
1. Wähle "Einloggen und verbinden"
1. Die Browserapplet wird starten

##### Spielupdate Fenster

Um diese Methode zu nutzen, musst du mindestens ein Spiel auf deinem Homescreen haben.

Beachte, dass wenn du nicht mit den korrekten DNS Servern verbunden bist, diese Methode dein Gerät updaten *wird*. Das ist gefährlich!
{: .notice--danger}

1. Drücke (+) mit irgendeinem Spiel ausgewählt
1. Im "Softwareupdate" Reiter, wähle "Über das Internet"
1. Die Browserapplet wird starten

___

You can now easily connect to your device using the PegaSwitch environment.
{: .notice--success}

For debugging purposes, you may want to [enable extra error info](troubleshooting#enable-extra-error-info).
{: .notice--info}

### Return to [Homebrew Development](homebrew-development)
{: .notice--primary}